{
   "AWSTemplateFormatVersion":"2010-09-09",
   "Description":"Stack to create Tenant Role Policy",
   "Parameters":{
      "Environment":{
         "Type":"String",
         "Description":"Enter the environment name as dev/qa/perf/uat/sec/prod/dr",
         "AllowedValues":[
            "dev",
            "perf",
            "qa",
            "uat",
            "sec",
            "prod",
            "pen",
            "uat1",
            "dr"
         ],
         "Default":"dev",
         "MaxLength":4,
         "MinLength":2
      },
      "Tenant":{
         "Type":"String",
         "Description":"Enter the tenant/country key",
         "Default":"os-kfc-in",
         "MaxLength":9,
         "MinLength":9
      },
      "AppName":{
         "Type":"String",
         "Default":"orderserv",
         "Description":"Application Name"
      }
   },
   "Conditions":{
      "IsAusTenant":{
         "Fn::Equals":[
            {
               "Ref":"Tenant"
            },
            "os-kfc-au"
         ]
      },
	  "IsThaTenant":{
         "Fn::Equals":[
            {
               "Ref":"Tenant"
            },
            "os-kfc-th"
         ]
      }
   },
   "Resources":{
      "ECSAutoScalingRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSAutoScalingRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "ecs.application-autoscaling.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSAutoScalingPolicy"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Effect":"Allow",
                           "Action":[
                              "ecs:DescribeServices",
                              "ecs:UpdateService"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:ecs:${AWS::Region}:${AWS::AccountId}:cluster/orderserv-${Environment}-${Tenant}-ecs"
                           }
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "cloudwatch:PutMetricAlarm",
                              "cloudwatch:DescribeAlarms",
                              "cloudwatch:GetMetricStatistics",
                              "cloudwatch:SetAlarmState",
                              "cloudwatch:DeleteAlarms"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:cloudwatch:${AWS::Region}:${AWS::AccountId}:alarm:*"
                           }
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "logs:CreateLogStream",
                              "logs:CreateLogGroup",
                              "logs:PutLogEvents"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:orderserv-${Environment}-${Tenant}-ecs:*"
                           }
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSAutoScalingRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "ECSExecutionRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSExecutionRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "ecs-tasks.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSExecutionPolicy"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Effect":"Allow",
                           "Action":[
                              "ecr:GetAuthorizationToken",
                              "ecr:BatchCheckLayerAvailability",
                              "ecr:GetDownloadUrlForLayer",
                              "ecr:BatchGetImage"
                           ],
                           "Resource":[
                              "*"
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "secretsmanager:GetSecretValue"
                           ],
                           "Resource":[
                              "*"
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "cloudwatch:PutMetricAlarm",
                              "cloudwatch:DescribeAlarms",
                              "cloudwatch:GetMetricStatistics",
                              "cloudwatch:SetAlarmState",
                              "cloudwatch:DeleteAlarms"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:cloudwatch:${AWS::Region}:${AWS::AccountId}:alarm:*"
                              }
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "logs:CreateLogStream",
                              "logs:CreateLogGroup",
                              "logs:PutLogEvents"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:orderserv-${Environment}-${Tenant}-ecs:*"
                           }
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSExecutionRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "ECSTaskRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSTaskRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "ecs-tasks.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSTaskRolePolicy"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Effect":"Allow",
                           "Action":[
                              "s3:DeleteObject",
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-*/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "dynamodb:GetItem",
                              "dynamodb:BatchGetItem",
                              "dynamodb:Query",
                              "dynamodb:PutItem",
                              "dynamodb:UpdateItem",
                              "dynamodb:DeleteItem",
                              "dynamodb:BatchWriteItem",
                              "dynamodb:UpdateTimeToLive",
                              "dynamodb:ConditionCheckItem",
                              "dynamodb:DescribeTimeToLive",
                              "dynamodb:GetRecords"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${Environment}.${Tenant}.*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${Environment}-*"
                              }
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "cloudwatch:PutMetricAlarm",
                              "cloudwatch:DescribeAlarms",
                              "cloudwatch:GetMetricStatistics",
                              "cloudwatch:SetAlarmState",
                              "cloudwatch:DeleteAlarms"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:cloudwatch:${AWS::Region}:${AWS::AccountId}:alarm:*"
                           }
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "logs:CreateLogStream",
                              "logs:CreateLogGroup",
                              "logs:PutLogEvents"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:orderserv-${Environment}-${Tenant}-ecs:*"
                           }
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "ssm:GetParametersByPath",
                              "ssm:GetParameters",
                              "ssm:GetParameter"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/config/${Environment}-${Tenant}-*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${Environment}/*"
                              }
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "xray:PutTraceSegments",
                              "xray:PutTelemetryRecords",
                              "xray:GetSamplingRules",
                              "xray:GetSamplingTargets",
                              "xray:GetSamplingStatisticSummaries"
                           ],
                           "Resource":[
                              "*"
                           ]
                        },
                        {
                           "Action":[
                              "servicediscovery:Get*",
                              "servicediscovery:List*",
                              "servicediscovery:DiscoverInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "servicediscovery:DeregisterInstance",
                              "servicediscovery:Get*",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:List*",
                              "servicediscovery:RegisterInstance"
                           ],
                           "Resource":"*"
                        },
                        {
                           "Action":[
                              "states:StartExecution",
                              "appconfig:GetConfiguration"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-ECSTaskRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "PWATaskExecutionRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-PWATaskExecutionRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "ecs-tasks.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-PWATaskExecutionRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Effect":"Allow",
                           "Action":[
                              "secretsmanager:GetSecretValue"
                           ],
                           "Resource":[
                              "*"
                           ]
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "ecr:GetAuthorizationToken",
                              "ecr:BatchCheckLayerAvailability",
                              "ecr:GetDownloadUrlForLayer",
                              "ecr:BatchGetImage"
                           ],
                           "Resource":"*"
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "ecs:DescribeTaskDefinition"
                           ],
                           "Resource":"*"
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "logs:CreateLogStream",
                              "logs:CreateLogGroup",
                              "logs:PutLogEvents"
                           ],
                           "Resource":"*"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-PWATaskExecutionRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "PWATaskRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-PWATaskRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "ecs-tasks.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-PWATaskRolePolicy"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "ssm:DescribeParameters",
                              "ssm:GetParameters",
                              "ssm:GetParameter",
                              "ssm:GetParametersByPath"
                           ],
                           "Resource":{
                              "Fn::Sub":"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${Environment}/${Tenant}/olo/*"
                           },
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-PWATaskRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "TenantConfigLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-TenantConfigLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-TenantConfigLambdaPolicy"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Effect":"Allow",
                           "Action":"dynamodb:GetItem",
                           "Resource":{
                              "Fn::Sub":"arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${Environment}.${Tenant}.*"
                           }
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "cloudwatch:PutMetricData"
                           ],
                           "Resource":"*"
                        },
                        {
                           "Effect":"Allow",
                           "Action":[
                              "logs:CreateLogStream",
                              "logs:CreateLogGroup",
                              "logs:PutLogEvents"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/*"
                              }
                           ]
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":[
                              "*"
                           ],
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-TenantConfigLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "AdminBffLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AdminBffLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AdminBffLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "*"
                           ],
                           "Resource":{
                              "Fn::Join":[
                                 "",
                                 [
                                    {
                                       "Fn::Sub":"arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${Environment}-${Tenant}-"
                                    },
                                    "*"
                                 ]
                              ]
                           },
                           "Effect":"Allow",
                           "Sid":"StackResources"
                        },
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "iam:TagRole",
                              "sqs:*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:CreateBucket",
                              "s3:DeleteBucket",
                              "s3:DeleteBucketWebsite",
                              "s3:PutAccelerateConfiguration",
                              "s3:PutAnalyticsConfiguration",
                              "s3:PutBucketAcl",
                              "s3:PutBucketCORS",
                              "s3:PutBucketLogging",
                              "s3:PutBucketNotification",
                              "s3:PutBucketPublicAccessBlock",
                              "s3:PutBucketVersioning",
                              "s3:PutBucketWebsite",
                              "s3:PutEncryptionConfiguration",
                              "s3:PutInventoryConfiguration",
                              "s3:PutLifecycleConfiguration",
                              "s3:PutMetricsConfiguration",
                              "s3:PutReplicationConfiguration",
                              "s3:PutBucketTagging",
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:ListBucket"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "states:StartExecution"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "SNS:Publish"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:sns:${AWS::Region}:${AWS::AccountId}:orderserv-${Environment}-${Tenant}-*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:sns:${AWS::Region}:${AWS::AccountId}:orderserv-${Environment}-SendEmailEvent"
                              }
                           ],
                           "Effect":"Allow",
                           "Sid":"SNSAccess"
                        },
                        {
                           "Action":[
                              "ssm:DescribeParameters",
                              "ssm:GetParameters",
                              "ssm:GetParameter",
                              "ssm:PutParameter"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"ParamStorePermissions"
                        },
                        {
                           "Action":[
                              "cloudfront:CreateInvalidation"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"CloudFrontPermissions"
                        },
                        {
                           "Action":[
                              "appconfig:GetConfiguration",
                              "appconfig:StartConfigurationSession",
                              "appconfig:GetLatestConfiguration"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"AppConfigPermissions"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AdminBffLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "AgintgrtnLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AgintgrtnLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AgintgrtnLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "*"
                           ],
                           "Resource":{
                              "Fn::Join":[
                                 "",
                                 [
                                    {
                                       "Fn::Sub":"arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${Environment}-${Tenant}-"
                                    },
                                    "*"
                                 ]
                              ]
                           },
                           "Effect":"Allow",
                           "Sid":"StackResources"
                        },
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "iam:TagRole",
                              "sqs:*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:CreateBucket",
                              "s3:DeleteBucket",
                              "s3:DeleteBucketWebsite",
                              "s3:PutAccelerateConfiguration",
                              "s3:PutAnalyticsConfiguration",
                              "s3:PutBucketAcl",
                              "s3:PutBucketCORS",
                              "s3:PutBucketLogging",
                              "s3:PutBucketNotification",
                              "s3:PutBucketPublicAccessBlock",
                              "s3:PutBucketVersioning",
                              "s3:PutBucketWebsite",
                              "s3:PutEncryptionConfiguration",
                              "s3:PutInventoryConfiguration",
                              "s3:PutLifecycleConfiguration",
                              "s3:PutMetricsConfiguration",
                              "s3:PutReplicationConfiguration",
                              "s3:PutBucketTagging",
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "states:StartExecution",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ssm:DescribeParameters",
                              "ssm:GetParameters",
                              "ssm:GetParameter",
                              "ssm:PutParameter"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"ParamStorePermissions"
                        },
                        {
                           "Action":[
                              "cloudfront:CreateInvalidation"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"CloudFrontPermissions"
                        },
                        {
                           "Action":[
                              "appconfig:GetConfiguration",
                              "appconfig:StartConfigurationSession",
                              "appconfig:GetLatestConfiguration"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"AppConfigPermissions"
                        },
                        {
                           "Sid":"KinesisPermissions",
                           "Effect":"Allow",
                           "Action":[
                              "kinesis:PutRecord",
                              "kinesis:PutRecords",
                              "kinesis:GetRecords",
                              "kinesis:DescribeStream",
                              "kinesis:DescribeStreamSummary",
                              "kinesis:GetShardIterator",
                              "kinesis:ListShards",
                              "kinesis:ListStreams",
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:PutLogEvents"
                           ],
                           "Resource":"*"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AgintgrtnLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "RefndmgmtLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-RefndmgmtLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-RefndmgmtLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "*"
                           ],
                           "Resource":{
                              "Fn::Join":[
                                 "",
                                 [
                                    {
                                       "Fn::Sub":"arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${Environment}-${Tenant}-"
                                    },
                                    "*"
                                 ]
                              ]
                           },
                           "Effect":"Allow",
                           "Sid":"StackResources"
                        },
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "iam:TagRole",
                              "sqs:*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:CreateBucket",
                              "s3:DeleteBucket",
                              "s3:DeleteBucketWebsite",
                              "s3:PutAccelerateConfiguration",
                              "s3:PutAnalyticsConfiguration",
                              "s3:PutBucketAcl",
                              "s3:PutBucketCORS",
                              "s3:PutBucketLogging",
                              "s3:PutBucketNotification",
                              "s3:PutBucketPublicAccessBlock",
                              "s3:PutBucketVersioning",
                              "s3:PutBucketWebsite",
                              "s3:PutEncryptionConfiguration",
                              "s3:PutInventoryConfiguration",
                              "s3:PutLifecycleConfiguration",
                              "s3:PutMetricsConfiguration",
                              "s3:PutReplicationConfiguration",
                              "s3:PutBucketTagging",
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "states:StartExecution",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ssm:DescribeParameters",
                              "ssm:GetParameters",
                              "ssm:GetParameter",
                              "ssm:PutParameter"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"ParamStorePermissions"
                        },
                        {
                           "Action":[
                              "cloudfront:CreateInvalidation"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"CloudFrontPermissions"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-RefndmgmtLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "CateringServiceLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsAusTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatSrvLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatSrvLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/catering/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-OrderServiceWorkflow"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatSrvLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "CateringNfcnSrvLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsAusTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatNfcnSrvLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatNfcnSrvLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/catering/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-OrderServiceWorkflow"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatNfcnSrvLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "CatrngChkNfcnSrvLmbdRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsAusTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/catering/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
	  "THCateringServiceLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsThaTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatSrvLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatSrvLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/catering/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-OrderServiceWorkflow"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatSrvLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "THCateringNfcnSrvLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsThaTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatNfcnSrvLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatNfcnSrvLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/catering/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-OrderServiceWorkflow"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatNfcnSrvLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "THCatrngChkNfcnSrvLmbdRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsThaTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/catering/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-CatChkNfcnSrvLmbdRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "StoreLivewfLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsAusTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-StoreLivewfLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-StoreLivewfLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "states:StartExecution"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:states:${AWS::Region}:${AWS::AccountId}:stateMachine:orderserv-${Environment}-${Tenant}-StoreAliveWorkflow"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "appconfig:GetConfiguration",
                              "appconfig:StartConfigurationSession",
                              "appconfig:GetLatestConfiguration"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"AppConfigPermissions"
                        },
                        {
                           "Sid":"DescribeCacheClusters",
                           "Effect":"Allow",
                           "Action":[
                              "elasticache:DescribeCacheClusters"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:elasticache:${AWS::Region}:${AWS::AccountId}:replicationgroup:orderserv-${Environment}-${Tenant}-storlivewf-redis"
                              }
                           ]
                        },
                        {
                           "Sid":"ParameterStore",
                           "Effect":"Allow",
                           "Action":[
                              "ssm:GetParameters"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${Environment}/${Tenant}/androidversion"
                              },
                              {
                                 "Fn::Sub":"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${Environment}/${Tenant}/iosversion"
                              },
                              {
                                 "Fn::Sub":"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${Environment}/${Tenant}/appconfig"
                              }
                           ]
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-StoreLivewfLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "AUPymntRfndLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsAusTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AUPymntRfndLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AUPymntRfndLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:DeleteObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":[
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders"
                              },
                              {
                                 "Fn::Sub":"arn:aws:s3:::orderserv-${AWS::Region}-${Environment}-${Tenant}-orders/refundtool/*"
                              },
                              {
                                 "Fn::Sub":"arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
                              }
                           ],
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:ListServices",
                              "servicediscovery:ListOperations",
                              "servicediscovery:GetOperation",
                              "servicediscovery:DiscoverInstances",
                              "servicediscovery:ListTagsForResource",
                              "servicediscovery:GetInstancesHealthStatus",
                              "servicediscovery:ListNamespaces",
                              "servicediscovery:GetNamespace",
                              "servicediscovery:GetInstance",
                              "servicediscovery:GetService",
                              "servicediscovery:ListInstances"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-AUPymntRfndLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      },
      "OrderGuardLambdaRole":{
         "Type":"AWS::IAM::Role",
         "Condition":"IsAusTenant",
         "Properties":{
            "RoleName":{
               "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-OrderGuardLambdaRole"
            },
            "AssumeRolePolicyDocument":{
               "Version":"2012-10-17",
               "Statement":[
                  {
                     "Effect":"Allow",
                     "Principal":{
                        "Service":[
                           "lambda.amazonaws.com"
                        ]
                     },
                     "Action":[
                        "sts:AssumeRole"
                     ]
                  }
               ]
            },
            "Path":"/",
            "Policies":[
               {
                  "PolicyName":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-OrderGuardLambdaRole"
                  },
                  "PolicyDocument":{
                     "Version":"2012-10-17",
                     "Statement":[
                        {
                           "Action":[
                              "*"
                           ],
                           "Resource":{
                              "Fn::Join":[
                                 "",
                                 [
                                    {
                                       "Fn::Sub":"arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${Environment}-${Tenant}-"
                                    },
                                    "*"
                                 ]
                              ]
                           },
                           "Effect":"Allow",
                           "Sid":"StackResources"
                        },
                        {
                           "Action":[
                              "logs:CreateLogGroup",
                              "logs:CreateLogStream",
                              "logs:DescribeLogGroups",
                              "logs:PutLogEvents",
                              "xray:Put*",
                              "iam:TagRole",
                              "sqs:*",
                              "dynamodb:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"StaticPermissions"
                        },
                        {
                           "Action":[
                              "s3:CreateBucket",
                              "s3:DeleteBucket",
                              "s3:DeleteBucketWebsite",
                              "s3:PutAccelerateConfiguration",
                              "s3:PutAnalyticsConfiguration",
                              "s3:PutBucketAcl",
                              "s3:PutBucketCORS",
                              "s3:PutBucketLogging",
                              "s3:PutBucketNotification",
                              "s3:PutBucketPublicAccessBlock",
                              "s3:PutBucketVersioning",
                              "s3:PutBucketWebsite",
                              "s3:PutEncryptionConfiguration",
                              "s3:PutInventoryConfiguration",
                              "s3:PutLifecycleConfiguration",
                              "s3:PutMetricsConfiguration",
                              "s3:PutReplicationConfiguration",
                              "s3:PutBucketTagging",
                              "s3:PutObject",
                              "s3:GetObject",
                              "s3:ListBucket",
                              "kms:GenerateDataKey",
                              "kms:Decrypt"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "states:CreateStateMachine",
                              "states:StartExecution",
                              "SNS:Publish"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "servicediscovery:*"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ec2:CreateNetworkInterfacePermission",
                              "ec2:CreateNetworkInterface",
                              "ec2:DescribeNetworkInterfaces",
                              "ec2:DeleteNetworkInterface",
                              "ec2:DeleteNetworkInterfacePermission",
                              "ec2:AssignPrivateIpAddresses",
                              "ec2:UnassignPrivateIpAddresses"
                           ],
                           "Resource":"*",
                           "Effect":"Allow"
                        },
                        {
                           "Action":[
                              "ssm:DescribeParameters",
                              "ssm:GetParameters",
                              "ssm:GetParameter",
                              "ssm:PutParameter"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"ParamStorePermissions"
                        },
                        {
                           "Action":[
                              "cloudfront:CreateInvalidation"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"CloudFrontPermissions"
                        },
                        {
                           "Action":[
                              "appconfig:GetConfiguration",
                              "appconfig:StartConfigurationSession",
                              "appconfig:GetLatestConfiguration"
                           ],
                           "Resource":"*",
                           "Effect":"Allow",
                           "Sid":"AppConfigPermissions"
                        },
                        {
                           "Sid":"SecretsManagerDbCredentialsAccess",
                           "Effect":"Allow",
                           "Action":[
                              "secretsmanager:GetSecretValue",
                              "secretsmanager:PutResourcePolicy",
                              "secretsmanager:PutSecretValue",
                              "secretsmanager:DeleteSecret",
                              "secretsmanager:DescribeSecret",
                              "secretsmanager:TagResource"
                           ],
                           "Resource":"arn:aws:secretsmanager:*:*:secret:rds-db-credentials/*"
                        },
                        {
                           "Sid":"RDSDataServiceAccess",
                           "Effect":"Allow",
                           "Action":[
                              "dbqms:CreateFavoriteQuery",
                              "dbqms:DescribeFavoriteQueries",
                              "dbqms:UpdateFavoriteQuery",
                              "dbqms:DeleteFavoriteQueries",
                              "dbqms:GetQueryString",
                              "dbqms:CreateQueryHistory",
                              "dbqms:DescribeQueryHistory",
                              "dbqms:UpdateQueryHistory",
                              "dbqms:DeleteQueryHistory",
                              "rds-data:ExecuteSql",
                              "rds-data:ExecuteStatement",
                              "rds-data:BatchExecuteStatement",
                              "rds-data:BeginTransaction",
                              "rds-data:CommitTransaction",
                              "rds-data:RollbackTransaction",
                              "secretsmanager:CreateSecret",
                              "secretsmanager:ListSecrets",
                              "secretsmanager:GetRandomPassword",
                              "tag:GetResources"
                           ],
                           "Resource":"*"
                        }
                     ]
                  }
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":{
                     "Fn::Sub":"orderserv-${AWS::Region}-${Environment}-${Tenant}-OrderGuardLambdaRole"
                  }
               },
               {
                  "Key":"AppName",
                  "Value":{
                     "Ref":"AppName"
                  }
               },
               {
                  "Key":"Environment",
                  "Value":{
                     "Ref":"Environment"
                  }
               },
               {
                  "Key":"Tenant",
                  "Value":{
                     "Ref":"Tenant"
                  }
               }
            ]
         }
      }
   },
   "Outputs":{
      "TenatRolePolicyStackName":{
         "Description":"TenantRolePolicyStackName",
         "Value":{
            "Fn::Sub":"${AWS::StackName}"
         }
      },
      "ECSTaskRole":{
         "Value":{
            "Ref":"ECSTaskRole"
         }
      },
      "ECSTaskRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "ECSTaskRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-ECSTaskRoleARN"
            }
         }
      },
      "ECSExecutionRole":{
         "Value":{
            "Ref":"ECSExecutionRole"
         }
      },
      "ECSExecutionRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "ECSExecutionRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-ECSExecutionRoleARN"
            }
         }
      },
      "PWATaskExecutionRole":{
         "Value":{
            "Ref":"PWATaskExecutionRole"
         }
      },
      "PWATaskExecutionRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "PWATaskExecutionRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-PWATaskExecutionRoleARN"
            }
         }
      },
      "PWATaskRole":{
         "Value":{
            "Ref":"PWATaskRole"
         }
      },
      "PWATaskRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "PWATaskRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-PWATaskRoleARN"
            }
         }
      },
      "ECSAutoScalingRole":{
         "Value":{
            "Ref":"ECSAutoScalingRole"
         }
      },
      "ECSAutoScalingRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "ECSAutoScalingRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-ECSAutoScalingRoleARN"
            }
         }
      },
      "TenantConfigLambdaRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "TenantConfigLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-TenantConfigLambdaRoleARN"
            }
         }
      },
      "AdminBffLambdaRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "AdminBffLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-AdminBffLambdaRoleARN"
            }
         }
      },
      "AgintgrtnLambdaRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "AgintgrtnLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-AgintgrtnLambdaRoleARN"
            }
         }
      },
      "RefndmgmtLambdaRoleARN":{
         "Value":{
            "Fn::GetAtt":[
               "RefndmgmtLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-RefndmgmtLambdaRoleARN"
            }
         }
      },
      "CateringServiceLambdaRoleARN":{
         "Condition":"IsAusTenant",
         "Value":{
            "Fn::GetAtt":[
               "CateringServiceLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-CateringServiceLambdaRoleARN"
            }
         }
      },
      "CateringNfcnSrvLambdaRoleARN":{
         "Condition":"IsAusTenant",
         "Value":{
            "Fn::GetAtt":[
               "CateringNfcnSrvLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-CateringNfcnSrvLambdaRoleARN"
            }
         }
      },
      "CatrngChkNfcnSrvLmbdRoleeARN":{
         "Condition":"IsAusTenant",
         "Value":{
            "Fn::GetAtt":[
               "CatrngChkNfcnSrvLmbdRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-CatrngChkNfcnSrvLmbdRoleARN"
            }
         }
      },
      "StoreLivewfLambdaRoleARN":{
         "Condition":"IsAusTenant",
         "Value":{
            "Fn::GetAtt":[
               "StoreLivewfLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-StoreLivewfLambdaRoleARN"
            }
         }
      },
      "AUPymntRfndLambdaRoleARN":{
         "Condition":"IsAusTenant",
         "Value":{
            "Fn::GetAtt":[
               "AUPymntRfndLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-AUPymntRfndLambdaRoleARN"
            }
         }
      },
      "OrderGuardLambdaRole":{
         "Condition":"IsAusTenant",
         "Value":{
            "Fn::GetAtt":[
               "OrderGuardLambdaRole",
               "Arn"
            ]
         },
         "Export":{
            "Name":{
               "Fn::Sub":"${AWS::StackName}-OrderGuardLambdaRole"
            }
         }
      }
   }
}